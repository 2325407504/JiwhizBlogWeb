<!--
	List current logged in author all blog posts. 
-->
<div class="post">
	<h2>List Blog Posts ({{blogs.length}}):</h2>

	<!-- Pagination TODO -->
	

	<table class="table">
		<thead>
			<tr>
				<th>Title</th>
				<th>Content</th>
				<th>Tags</th>
				<th>Visits</th>
			</tr>
		</thead>

		<tbody>
			<tr ng-repeat="blog in blogs">
				<!-- Title, with Edit Meta link -->
				<td>
					<h5>{{blog.title}}</h5>
					<div class="manage-data-toolbar">
						<!-- edit meta -->
						<a href="#/myPost/updateBlogMeta/{{blog.blogId}}">
							<i class="icon-pencil" title="Edit"></i> Edit
						</a>
					</div>
				</td>

				<!-- Content (just summary with Read more link if published; or summary text. Edit content link -->
				<td>
					<div class="manage-data-info text-info">
						<i class="{{blog.iconClass}}" title="{{blog.iconTitle}}"></i>
						Created at  {{blog.createdTime | date:'medium'}} |
						Last modified at  {{blog.lastModifiedTime | date:'medium'}}
					</div>
					<div>
						<div ng-show="blog.published">
							<h4 class="text-info">{{blog.fullPublishedPath}}</h4>
						</div>
						<div ng-show="!blog.published">
							<h4 class="text-warning">Un-published</h4>
						</div>
						<p>
							<span ng-bind-html-unsafe="blog.contentFirstParagraph"></span>
						</p>
						<p ng-show="blog.published"><strong>
							<a href="#/blog/{{blog.fullPublishedPath}}" class="popupWin">Read more &raquo;</a></strong>
						</p>
					</div>
					<div class="manage-data-toolbar">
						<!-- edit content -->
						<a href="#/myPost/updateBlogContent/{{blog.blogId}}"> <i class="icon-pencil" title="Edit"></i>
							Edit Content
						</a> | 
						<a href="#/myPost/reviewBlog/{{blog.blogId}}"> <i class="icon-eye-open" title="Review"></i>
							Review Blog Post
						</a>
					</div>
					<hr /> 
					
					<!-- List of comment -->
					<button ng-click="triggerCommentsCollapse(blog)">
						<i class="icon-chevron-right" ng-show="blog.commentsCollapsed"></i>
						<i class="icon-chevron-down" ng-show="!blog.commentsCollapsed"></i>
					</button>
					{{blog.totalCommentCount | CommentCount}} On This Post:
					<div collapse="blog.commentsCollapsed">
						<table class="table table-striped table-bordered bootstrap-datatable" ng-show="blog.totalCommentCount>0">
							<thead>
								<tr>
									<th>Poster</th>
									<th>Comment</th>
								</tr>
							</thead>

							<tbody>
								<tr ng-repeat="comment in blog.comments">
									<!-- User -->
									<td>
										<member-info member="comment.user"></member-info>
									</td>
	
									<!-- Comment -->
									<td>
										<div class="manage-data-info text-info">
											Posted on {{comment.postedTime | date:'medium'}} | 
											<span class="{{comment.status.textClass}}">
												<i class="{{comment.status.iconClass}}" title="{{comment.status.title}}"></i>
												{{comment.status.name}}</span>
										</div>
										<div>
											<p>
												<markdown content="{{comment.content}}"></markdown>
											</p>
										</div>
										<div class="manage-comment-toolbar">
											<ul class="action-list">
												<li ng-repeat="action in comment.actions"> 
													<a href="" ng-click="action.actionFunction(blog, comment)">
														<i class="{{action.iconClass}}" title="{{action.title}}"></i> 
														{{action.name}}
													</a>
												</li>
											</ul>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>

				</td>

				<!-- Tags -->
				<td>
					<span ng-repeat="tag in blog.tags" class="label label-info">{{tag}} </span>
					<div class="manage-data-toolbar">
						<!-- edit meta -->
						<a href="#/myPost/updateBlogMeta/{{blog.blogId}}"> <i class="icon-pencil" title="Edit"></i>
							Edit
						</a>
					</div></td>

				<!-- Visits -->
				<td>{{blog.visits}}</td>
			</tr>
		</tbody>
	</table>

	<!-- Pagination -->
	
	<p>
		<a href="#/myPost/createBlog" class="btn btn-primary">Add Post</a>
	</p>

</div>
